{
  "version": 3,
  "sources": ["../../react-three-map/src/api/use-map.ts", "../../react-three-map/src/core/coords-to-matrix.ts", "../../react-three-map/src/core/use-coords-to-matrix.ts", "../../react-three-map/src/core/sync-camera.ts", "../../react-three-map/src/core/use-function.ts", "../../react-three-map/src/core/canvas-in-layer/use-render.ts", "../../react-three-map/src/core/events.ts", "../../react-three-map/src/core/use-coords.tsx", "../../react-three-map/src/core/use-r3m.ts", "../../react-three-map/src/core/canvas-in-layer/use-root.tsx", "../../react-three-map/src/core/canvas-in-layer/use-canvas-in-layer.tsx", "../../react-three-map/src/core/canvas-overlay/init-r3m.tsx", "../../react-three-map/src/core/canvas-overlay/sync-camera-fc.tsx", "../../react-three-map/src/core/canvas-overlay/canvas-portal.tsx", "../../react-three-map/src/core/canvas-overlay/init-canvas-fc.tsx", "../../react-three-map/src/maplibre/canvas.tsx", "../../react-three-map/src/api/coordinates.tsx", "../../react-three-map/src/core/earth-radius.ts", "../../react-three-map/src/api/coords-to-vector-3.ts", "../../react-three-map/src/api/near-coordinates.tsx", "../../react-three-map/src/api/vector-3-to-coords.ts", "../../react-three-map/src/maplibre.index.ts"],
  "sourcesContent": ["import { useThree } from \"@react-three/fiber\";\nimport { MapInstance } from \"../core/generic-map\";\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const useMap = <T extends MapInstance = MapInstance>(): T => useThree((s: any) => {\n  return s.r3m?.map;\n});", "import { Euler, Matrix4, Quaternion, Vector3 } from \"three\";\nimport { FromLngLat } from \"./generic-map\";\nimport { Coords } from \"../api/coords\";\n\nconst quat = new Quaternion();\nconst euler = new Euler();\nconst pos = new Vector3();\nconst scale = new Vector3();\nconst m4 = new Matrix4();\n\n/** calculate Matrix4 from coordinates */\nexport function coordsToMatrix({\n  longitude, latitude, altitude, fromLngLat\n}: Coords & { fromLngLat: FromLngLat }) {\n  const center = fromLngLat([longitude, latitude], altitude);\n  const scaleUnit = center.meterInMercatorCoordinateUnits();\n  pos.set(center.x, center.y, center.z || 0);\n  scale.set(scaleUnit, -scaleUnit, scaleUnit);\n  quat.setFromEuler(euler.set(-Math.PI * .5, 0, 0));\n  return m4.compose(pos, quat, scale).toArray();\n}\n", "import { useMemo } from \"react\";\nimport { coordsToMatrix } from \"./coords-to-matrix\";\n\ntype Props = Parameters<typeof coordsToMatrix>[0];\n\n/** calculate matrix from coordinates */\nexport function useCoordsToMatrix({latitude, longitude, altitude, fromLngLat}: Props) {\n  const m4 = useMemo(() => coordsToMatrix({\n    latitude, longitude, altitude, fromLngLat,\n  }), [latitude, longitude, altitude, fromLngLat]);\n\n  return m4;\n}", "import { Matrix4, Matrix4Tuple, Object3D, PerspectiveCamera, Vector3 } from \"three\";\n\nconst originMx = new Matrix4();\n\n/** projection * view matrix  */\nconst projByView = new Matrix4();\n/** projection * view matrix inverted */\nconst projByViewInv = new Matrix4();\n\n/** forward */\nconst fwd = new Vector3();\n\n\nexport function syncCamera(camera: PerspectiveCamera, origin: Matrix4Tuple, mapCamMx: Matrix4Tuple) {\n\n  projByView\n    .fromArray(mapCamMx)\n    .multiply(originMx.fromArray(origin));\n  projByViewInv\n    .copy(projByView)\n    .invert();\n\n  updateCamera(camera, projByViewInv);\n  camera.updateMatrix();\n  camera.updateMatrixWorld(true);  \n\n  camera.projectionMatrix.copy(camera.matrix).premultiply(projByView);\n  camera.projectionMatrixInverse.copy(camera.projectionMatrix).invert();\n\n  camera.far = calculateFar(\n    camera.matrix.elements[10], camera.matrix.elements[14], camera.near\n  )\n\n  camera.userData.projByView = projByView.toArray();\n  camera.userData.projByViewInv = projByViewInv.toArray();\n\n}\n\nconst updateCamera = (target: Object3D, projByViewInv: Matrix4) => {\n\n  target.position\n    .setScalar(0)\n    .applyMatrix4(projByViewInv)\n\n  target.up\n    .set(0, -1, 0)\n    .applyMatrix4(projByViewInv)\n    .negate()\n    .add(target.position)\n    .normalize()\n\n  fwd\n    .set(0, 0, 1)\n    .applyMatrix4(projByViewInv)\n\n  target.lookAt(fwd);\n\n}\n\nfunction calculateFar(c: number, d: number, near: number): number {\n  const numerator = d * (c - 1);\n  const denominator = c * near + near;\n  const far = numerator / denominator;\n  return far;\n}", "import { useCallback, useRef } from 'react';\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nexport const useFunction = <T extends (...args: any[]) => any>(callback: T): T => {\n  const callbackRef = useRef(callback);\n  callbackRef.current = callback;\n  return useCallback((...args: any[]) => {\n    return callbackRef.current(...args);\n  }, []) as T;\n};\n", "import { RootState } from \"@react-three/fiber\";\nimport { Matrix4Tuple, PerspectiveCamera } from \"three\";\nimport { UseBoundStore } from \"zustand\";\nimport { MapInstance } from \"../generic-map\";\nimport { syncCamera } from \"../sync-camera\";\nimport { useFunction } from \"../use-function\";\nimport { R3M } from \"../use-r3m\";\n\nexport function useRender({\n  map, origin, useThree, frameloop, r3m,\n} :{\n  map: MapInstance,\n  origin: Matrix4Tuple,\n  useThree: UseBoundStore<RootState>,\n  frameloop?: 'always' | 'demand',\n  r3m: R3M\n}) {\n  const render = useFunction((_gl: WebGL2RenderingContext, projViewMx: number[] | {defaultProjectionData: {mainMatrix: Record<string, number>}}) => {\n    const pVMx = 'defaultProjectionData' in projViewMx ? Object.values(projViewMx.defaultProjectionData.mainMatrix) : projViewMx;\n    r3m.viewProjMx.splice(0, 16, ...pVMx)\n    const state = useThree.getState();\n    const camera = state.camera as PerspectiveCamera;\n    const {gl, advance} = state;\n    syncCamera(camera as PerspectiveCamera, origin, pVMx as Matrix4Tuple);\n    gl.resetState();\n    advance(Date.now() * 0.001, true);\n    if (!frameloop || frameloop === 'always') map.triggerRepaint();\n  })\n  return render;\n}", "import { Canvas, events as fiberEvents } from \"@react-three/fiber\";\nimport { Matrix4 } from \"three\";\n\n/** projection * view matrix inverted */\nconst projViewInv = new Matrix4()\n\ntype Events = Parameters<typeof Canvas>[0]['events'];\n\nexport const events: Events = (store) => {\n  const originalEvents = fiberEvents(store);\n  return {\n    ...originalEvents,\n    connect: target => {\n      if (!originalEvents.connect) return;\n      originalEvents.connect(target.parentElement!);  // eslint-disable-line @typescript-eslint/no-non-null-assertion\n    },\n    compute: (event, state) => {\n\n      state.pointer.x = (event.offsetX / state.size.width) * 2 - 1;\n      state.pointer.y = 1 - (event.offsetY / state.size.height) * 2;\n\n      if (state.camera.userData.projByViewInv) projViewInv.fromArray(state.camera.userData.projByViewInv);\n\n      state.raycaster.camera = state.camera;\n      state.raycaster.ray.origin.setScalar(0).applyMatrix4(projViewInv);\n      state.raycaster.ray.direction\n        .set(state.pointer.x, state.pointer.y, 1)\n        .applyMatrix4(projViewInv)\n        .sub(state.raycaster.ray.origin)\n        .normalize();\n\n    },\n  };\n};", "import { RootState, _roots, useThree } from \"@react-three/fiber\";\nimport { useMemo } from \"react\";\nimport { UseBoundStore } from 'zustand';\nimport { Coords } from \"../api/coords\";\n\nexport function useCoords() {\n  const coords = useThree(s=>(s as any).coords) as Coords; // eslint-disable-line @typescript-eslint/no-explicit-any\n  return coords;\n}\n\nexport function useSetCoords({longitude, latitude, altitude}: Coords) {\n  \n  const canvas = useThree(s => s.gl.domElement);\n  useMemo(()=>{\n    const store = _roots.get(canvas)!.store; // eslint-disable-line @typescript-eslint/no-non-null-assertion\n    const coords : Coords = { longitude, latitude, altitude };\n    setCoords(store, coords);\n  }, [longitude, latitude, altitude]) // eslint-disable-line react-hooks/exhaustive-deps\n}\n\nexport function useSetRootCoords(store:UseBoundStore<RootState>, {\n  longitude, latitude, altitude\n}: Coords) {\n  useMemo(()=>{\n    setCoords(store, {longitude, latitude, altitude});\n  }, [longitude, latitude, altitude]) // eslint-disable-line react-hooks/exhaustive-deps\n}\n\nexport function setCoords(store:UseBoundStore<RootState>, coords: Coords) {\n  store.setState({coords} as any) // eslint-disable-line @typescript-eslint/no-explicit-any\n}", "import { RootState, _roots, useThree } from \"@react-three/fiber\";\nimport { useState } from \"react\";\nimport { Matrix4, Matrix4Tuple } from \"three\";\nimport { UseBoundStore } from 'zustand';\nimport { FromLngLat, MapInstance } from \"./generic-map\";\n\nexport interface R3M<T extends MapInstance = MapInstance> {\n  /** Map provider */\n  map: T,\n  /** view projection matrix coming from the map provider */\n  viewProjMx: Matrix4Tuple,\n  fromLngLat: FromLngLat,\n}\n\nexport function useR3M<T extends MapInstance> () {\n  const r3m = useThree(s=>(s as any).r3m) as R3M<T>; // eslint-disable-line @typescript-eslint/no-explicit-any\n  return r3m;\n}\n\n/** init `useR3M` hook */\nexport function useInitR3M<T extends MapInstance>(props: {\n  map: T; fromLngLat: FromLngLat;\n}) {\n  const canvas = useThree(s => s.gl.domElement);\n  // to run only once\n  useState(()=>{\n    const store = _roots.get(canvas)!.store; // eslint-disable-line @typescript-eslint/no-non-null-assertion\n    initR3M({...props, store})\n  })\n}\n\nexport function initR3M<T extends MapInstance>({store, ...props}: {\n  map: T;\n  fromLngLat: FromLngLat;\n  store: UseBoundStore<RootState>;\n}) {\n  const viewProjMx = new Matrix4().identity().toArray();\n  const r3m : R3M<T> = { ...props, viewProjMx };\n  store.setState({r3m} as any); // eslint-disable-line @typescript-eslint/no-explicit-any\n  return r3m;\n}", "import { _roots, createRoot } from \"@react-three/fiber\";\nimport { useEffect, useState } from \"react\";\nimport { CanvasProps } from \"../../api/canvas-props\";\nimport { events } from \"../events\";\nimport { FromLngLat, MapInstance } from \"../generic-map\";\nimport { setCoords, useSetRootCoords } from \"../use-coords\";\nimport { useFunction } from \"../use-function\";\nimport { initR3M } from \"../use-r3m\";\n\nexport function useRoot(\n  fromLngLat: FromLngLat,\n  map: MapInstance,\n  { frameloop, longitude, latitude, altitude, ...props }: CanvasProps\n) {\n\n  const [{ root, useThree, canvas, r3m }] = useState(() => {\n    const canvas = map.getCanvas();\n    const gl = (canvas.getContext('webgl2') || canvas.getContext('webgl')) as WebGLRenderingContext;\n\n    const root = createRoot(canvas);\n    root.configure({\n      dpr: window.devicePixelRatio,\n      events,\n      ...props,\n      frameloop: 'never',\n      gl: {\n        context: gl,\n        autoClear: false,\n        antialias: true,\n        ...props?.gl,\n      },\n      onCreated: (state) => {\n        state.gl.forceContextLoss = () => { }; // eslint-disable-line @typescript-eslint/no-empty-function\n      },\n      camera: {\n        matrixAutoUpdate: false,\n        near: 0,\n      },\n      size: {\n        width: canvas.clientWidth,\n        height: canvas.clientHeight,\n        top: canvas.offsetTop,\n        left: canvas.offsetLeft,\n        updateStyle: false,\n        ...props?.size,\n      },\n    });\n\n    const store = _roots.get(canvas)!.store; // eslint-disable-line @typescript-eslint/no-non-null-assertion\n\n    const r3m = initR3M({ map, fromLngLat, store });\n    setCoords(store, {longitude, latitude, altitude});\n\n    if (frameloop === 'demand') {\n      store.setState({\n        frameloop,\n        invalidate: () => {\n          map.triggerRepaint();\n        },\n      })\n    }\n\n    return { root, useThree: store, map, canvas, r3m }\n\n  })\n\n  const onResize = useFunction(() => {\n\n    const { setDpr, setSize } = useThree.getState();\n\n    setDpr(window.devicePixelRatio);\n\n    setSize(\n      canvas.clientWidth,\n      canvas.clientHeight,\n      false,\n      canvas.offsetTop,\n      canvas.offsetLeft,\n    );\n\n  })\n\n  const onRemove = useFunction(() => {\n    root.unmount();\n  })\n\n  useSetRootCoords(useThree, {longitude, latitude, altitude});\n\n  // on `frameloop` change\n  useEffect(() => {\n    if (frameloop !== 'demand') return;\n    const setState = useThree.setState;\n    const { invalidate } = useThree.getState();\n    setState({\n      frameloop,\n      invalidate: () => {\n        map.triggerRepaint();\n      }\n    });\n    return () => {\n      setState({ frameloop: 'never', invalidate })\n    }\n  }, [frameloop]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  // on mount / unmount\n  useEffect(() => {\n    map.on('resize', onResize);\n    return () => {\n      map.off('resize', onResize)\n    }\n  }, []) // eslint-disable-line react-hooks/exhaustive-deps\n\n  // root.render\n  useEffect(() => {\n    root.render(<>\n      {props.children}\n    </>);\n  }, [props.children]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  return { onRemove, useThree, r3m };\n}", "import { CanvasProps } from \"../../api/canvas-props\";\nimport { FromLngLat, MapInstance } from \"../generic-map\";\nimport { useCoordsToMatrix } from \"../use-coords-to-matrix\";\nimport { useRender } from \"./use-render\";\nimport { useRoot } from \"./use-root\";\n\n/** get all the properties that you need to render as a map `<Layer>` */\nexport function useCanvasInLayer(props: CanvasProps,fromLngLat: FromLngLat, map: MapInstance) {\n\n  const {latitude, longitude, altitude, frameloop } = props;\n\n    const origin = useCoordsToMatrix({\n      latitude, longitude, altitude, fromLngLat,\n    });\n\n    const { onRemove, useThree, r3m } = useRoot(fromLngLat, map, props);\n  \n    const render = useRender({origin, frameloop, useThree, map, r3m});\n  \n    return {\n      id: props.id,\n      beforeId: props.beforeId,\n      onRemove,\n      render,\n      type: 'custom',\n      renderingMode: '3d'\n    } as const\n\n}", "import { memo } from \"react\";\nimport { FromLngLat, MapInstance } from \"../generic-map\";\nimport { useInitR3M } from \"../use-r3m\";\nimport { useSetCoords } from \"../use-coords\";\nimport { Coords } from \"../../api/coords\";\n\ninterface InitR3MProps extends Coords {\n  map: MapInstance,\n  fromLngLat: FromLngLat,\n}\n\n/** Initialises the `R3M` hook */\nexport const InitR3M = memo<InitR3MProps>(({\n  longitude, latitude, altitude, ...props\n}) => {\n  useInitR3M(props);\n  useSetCoords({longitude, latitude, altitude});\n  return <></>\n})\nInitR3M.displayName = 'InitR3M';", "import { useFrame, useThree } from \"@react-three/fiber\";\nimport { memo, useEffect, useLayoutEffect, useMemo, useRef } from \"react\";\nimport { Matrix4Tuple, PerspectiveCamera } from \"three\";\nimport { Coords } from \"../../api/coords\";\nimport { MapInstance } from \"../generic-map\";\nimport { syncCamera } from \"../sync-camera\";\nimport { useCoordsToMatrix } from \"../use-coords-to-matrix\";\nimport { useFunction } from \"../use-function\";\nimport { useR3M } from \"../use-r3m\";\n\ninterface SyncCameraFCProps extends Coords {\n  setOnRender?: (callback: () => (mx: Matrix4Tuple) => void) => void,\n  /** on `useFrame` it will manually render (used by `<Coordinates>`) */\n  manualRender?: boolean,\n  onReady?: () => void,\n  map: MapInstance,\n}\n\n/** React Component (FC) to sync the Three camera with the map provider */\nexport const SyncCameraFC = memo<SyncCameraFCProps>(({\n  latitude, longitude, altitude = 0, setOnRender, manualRender, onReady, map\n}) => {\n\n  const mapCanvas = map.getCanvas();\n\n  const r3m = useR3M();\n\n  const camRef = useRef<PerspectiveCamera>(null);\n\n  const camera = useThree(s => s.camera) as PerspectiveCamera;\n  const gl = useThree(s => s.gl);\n  const threeCanvas = useThree(s => s.gl.domElement);\n  const scene = useThree(s => s.scene);\n  const advance = useThree(s => s.advance);\n  const setSize = useThree(s => s.setSize);\n  const set = useThree(s => s.set);\n\n  const origin = useCoordsToMatrix({ latitude, longitude, altitude, fromLngLat: r3m.fromLngLat });\n\n  const ready = useRef(false);\n\n  const triggerRepaint = useMemo(() => map.triggerRepaint, [map]);\n  const mapPaintRequests = useRef(0);\n  const triggerRepaintOff = useFunction(() => {\n    mapPaintRequests.current++;\n  })\n\n  useFrame(() => {\n    syncCamera(camera, origin, r3m.viewProjMx)\n\n    if (manualRender) gl.render(scene, camera);\n\n    map.triggerRepaint = triggerRepaint;\n    if (mapPaintRequests.current > 0) {\n      mapPaintRequests.current = 0;\n      map.triggerRepaint();\n    }\n  }, -Infinity)\n\n  const onRender = useFunction((viewProjMx: Matrix4Tuple | {defaultProjectionData: {mainMatrix: Record<string, number>}}) => {\n    map.triggerRepaint = triggerRepaintOff;\n\n    if (threeCanvas.width !== mapCanvas.width || threeCanvas.height !== mapCanvas.height) {\n      setSize(\n        mapCanvas.clientWidth,\n        mapCanvas.clientHeight,\n        true,\n        mapCanvas.offsetTop,\n        mapCanvas.offsetLeft,\n      );\n    }\n\n    const pVMx = 'defaultProjectionData' in viewProjMx ? Object.values(viewProjMx.defaultProjectionData.mainMatrix) : viewProjMx;\n    r3m.viewProjMx = pVMx as Matrix4Tuple;\n    if (!ready.current && onReady) {\n      ready.current = true;\n      onReady();\n    }\n    advance(Date.now() * .001, true);\n  })\n\n  useEffect(() => {\n    setOnRender && setOnRender(() => onRender)\n  }, [setOnRender, onRender])\n\n  useLayoutEffect(() => {\n    if (!manualRender) return;\n    set({ camera: camRef.current! }); // eslint-disable-line @typescript-eslint/no-non-null-assertion\n  }, []) // eslint-disable-line react-hooks/exhaustive-deps\n\n  return <>\n    {manualRender && <perspectiveCamera\n      ref={camRef}\n      matrixAutoUpdate={false}\n      matrixWorldAutoUpdate={false}\n    />}\n  </>\n})\n\nSyncCameraFC.displayName = 'SyncCameraFC';", "import { Canvas } from \"@react-three/fiber\";\nimport { memo, useState } from \"react\";\nimport { Matrix4Tuple } from \"three\";\nimport { CanvasProps } from \"../../api/canvas-props\";\nimport { events } from \"../events\";\nimport { FromLngLat, MapInstance } from \"../generic-map\";\nimport { useFunction } from \"../use-function\";\nimport { InitR3M } from \"./init-r3m\";\nimport { SyncCameraFC } from \"./sync-camera-fc\";\n\ninterface CanvasPortalProps extends CanvasProps {\n  setOnRender: (callback: () => (mx: Matrix4Tuple) => void) => void,\n  map: MapInstance,\n  fromLngLat: FromLngLat,\n}\n\nexport const CanvasPortal = memo<CanvasPortalProps>(({\n  children, latitude, longitude, altitude,\n  setOnRender, map, fromLngLat, ...props\n}) => {\n\n  const mapCanvas = map.getCanvas();\n  const eventSource = mapCanvas.parentElement!; // eslint-disable-line @typescript-eslint/no-non-null-assertion\n\n  const [ready, setReady] = useState(false);\n\n  const onReady = useFunction(() => {\n    setReady(true);\n  })\n\n  return <Canvas\n    events={events}\n    eventSource={eventSource}\n    {...props}\n    gl={{ autoClear: false, ...props.gl }}\n  >\n    <InitR3M\n      map={map}\n      fromLngLat={fromLngLat}\n      latitude={latitude}\n      longitude={longitude}\n      altitude={altitude}\n    />\n    <SyncCameraFC\n      latitude={latitude}\n      longitude={longitude}\n      altitude={altitude}\n      setOnRender={setOnRender}\n      onReady={onReady}\n      map={map}\n    />\n    {ready && children}\n  </Canvas>\n})\nCanvasPortal.displayName = 'CanvasPortal';\n", "import { memo, useEffect, useState } from \"react\";\nimport { createPortal } from 'react-dom';\nimport { Matrix4Tuple } from \"three\";\nimport { CanvasProps } from \"../../api/canvas-props\";\nimport { FromLngLat, MapInstance } from \"../generic-map\";\nimport { CanvasPortal } from \"./canvas-portal\";\n\ninterface InitCanvasFCProps extends CanvasProps {\n  map: MapInstance,\n  setOnRender: (callback: () => (mx: Matrix4Tuple) => void) => void,\n  frameloop?: 'always' | 'demand',\n  fromLngLat: FromLngLat,\n}\nexport const InitCanvasFC = memo<InitCanvasFCProps>((props) => {\n  const canvas = props.map.getCanvas() // eslint-disable-line @typescript-eslint/no-non-null-assertion\n\n  const [el] = useState(() => {\n    const el = document.createElement('div');\n    el.style.position = 'absolute';\n    el.style.top = '0';\n    el.style.bottom = '0';\n    el.style.left = '0';\n    el.style.right = '0';\n    el.style.pointerEvents = 'none';\n    return el\n  })\n\n  useEffect(() => {\n    const parent = canvas.parentElement!; // eslint-disable-line @typescript-eslint/no-non-null-assertion\n    parent.appendChild(el);\n    return () => {\n      parent.removeChild(el);\n    }\n  }, []) // eslint-disable-line react-hooks/exhaustive-deps\n  return <>\n    {createPortal((\n      <CanvasPortal {...props} />\n    ), el)}\n  </>\n})\nInitCanvasFC.displayName = 'InitCanvasFC';\n", "/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { extend } from \"@react-three/fiber\";\nimport { MercatorCoordinate } from \"maplibre-gl\";\nimport { memo, useState } from \"react\";\nimport { Layer, useMap } from \"react-map-gl/maplibre\";\nimport * as THREE from \"three\";\nimport { Matrix4Tuple } from \"three\";\nimport { CanvasProps } from \"../api/canvas-props\";\nimport { useCanvasInLayer } from \"../core/canvas-in-layer/use-canvas-in-layer\";\nimport { InitCanvasFC } from \"../core/canvas-overlay/init-canvas-fc\";\nimport { Render } from \"../core/canvas-overlay/render\";\nimport { MapInstance } from \"../core/generic-map\";\nimport { useFunction } from \"../core/use-function\";\n\nextend(THREE);\n\nconst fromLngLat = MercatorCoordinate.fromLngLat\n\n/** `react-three-fiber` canvas inside `MapLibre` */\nexport const Canvas = memo<CanvasProps>(({ overlay, ...props }) => {\n\n  const map = useMap().current!.getMap(); // eslint-disable-line @typescript-eslint/no-non-null-assertion\n\n  return <>\n    {overlay && <CanvasOverlay map={map} {...props} />}\n    {!overlay && <CanvasInLayer map={map} {...props} />}\n  </>\n})\nCanvas.displayName = 'Canvas'\n\ninterface CanvasPropsAndMap extends CanvasProps {\n  map: MapInstance;\n}\n\nconst CanvasInLayer = memo<CanvasPropsAndMap>(({ map, ...props }) => {\n  const layerProps = useCanvasInLayer(props, fromLngLat, map);\n  /* @ts-ignore */ // eslint-disable-line @typescript-eslint/ban-ts-comment\n  return <Layer {...layerProps} />\n})\nCanvasInLayer.displayName = 'CanvasInLayer';\n\nconst CanvasOverlay = memo<CanvasPropsAndMap>(({ map, id, beforeId, ...props }) => {\n  const [onRender, setOnRender] = useState<(mx: Matrix4Tuple) => void>();\n\n  const render = useFunction<Render>((_gl, mx) => {\n    if (!onRender) return;\n    onRender(mx as Matrix4Tuple);\n  })\n\n  return <>\n    {/* @ts-ignore */}\n    <Layer id={id} beforeId={beforeId} type=\"custom\" render={render} />\n    <InitCanvasFC {...props}\n      setOnRender={setOnRender}\n      map={map}\n      fromLngLat={fromLngLat}\n    />\n  </>\n})\nCanvasInLayer.displayName = 'CanvasInLayer';", "import { createPortal, useFrame, useThree } from \"@react-three/fiber\";\nimport { PropsWithChildren, memo, useLayoutEffect, useRef, useState } from \"react\";\nimport { Matrix4Tuple, PerspectiveCamera, Scene } from \"three\";\nimport { syncCamera } from \"../core/sync-camera\";\nimport { useCoordsToMatrix } from \"../core/use-coords-to-matrix\";\nimport { R3M, useR3M } from \"../core/use-r3m\";\n\nexport interface CoordinatesProps extends PropsWithChildren {\n  longitude: number,\n  latitude: number,\n  altitude?: number,\n}\n\nexport const Coordinates = memo<CoordinatesProps>(({\n  latitude, longitude, altitude = 0, children\n}) => {\n\n  const [scene] = useState(() => new Scene())\n\n  const r3m = useR3M();\n\n  const origin = useCoordsToMatrix({\n    latitude, longitude, altitude, fromLngLat: r3m.fromLngLat,\n  });\n\n\n  return <>{createPortal(<>\n    <RenderAtCoords r3m={r3m} origin={origin} />\n    {children}\n  </>, scene, { events: { priority: 2 } })}</>\n})\n\nCoordinates.displayName = 'Coordinates';\n\ninterface RenderAtCoordsProps {\n  r3m: R3M,\n  origin: Matrix4Tuple\n}\n\nfunction RenderAtCoords({ r3m, origin }: RenderAtCoordsProps) {\n\n  const { gl, scene, set } = useThree()\n\n  const cameraRef = useRef<PerspectiveCamera>(null)\n\n  useFrame(() => {\n    if (!cameraRef.current) return;\n    syncCamera(cameraRef.current, origin, r3m.viewProjMx);\n    gl.render(scene, cameraRef.current);\n  })\n\n  useLayoutEffect(() => {\n    if (!cameraRef.current) return;\n    set({\n      invalidate: () => {\n        if (!r3m.map) return;\n        r3m.map.triggerRepaint();\n      },\n      camera: cameraRef.current,\n    });\n  }, [set, r3m])\n\n  return <perspectiveCamera ref={cameraRef} />\n}", "export const earthRadius = 6371008.8;\n", "import { MathUtils, Vector3Tuple } from 'three';\nimport { Coords } from './coords';\nimport { earthRadius } from \"../core/earth-radius\";\n\n\nconst mercatorScaleLookup: { [key: number]: number } = {};\n\nfunction getMercatorScale(lat: number): number {\n  const index = Math.round(lat * 1000);\n  if (mercatorScaleLookup[index] === undefined) {\n    mercatorScaleLookup[index] = 1 / Math.cos(lat * MathUtils.DEG2RAD);\n  }\n  return mercatorScaleLookup[index];\n}\n\nexport function averageMercatorScale(originLat: number, pointLat: number, steps = 10): number {\n  let totalScale = 0;\n  const latStep = (pointLat - originLat) / steps;\n  for (let i = 0; i <= steps; i++) {\n    const lat = originLat + latStep * i;\n    totalScale += getMercatorScale(lat);\n  }\n  return totalScale / (steps + 1);\n}\n\nexport function coordsToVector3(point: Coords, origin: Coords): Vector3Tuple {\n  const latitudeDiff = (point.latitude - origin.latitude) * MathUtils.DEG2RAD;\n  const longitudeDiff = (point.longitude - origin.longitude) * MathUtils.DEG2RAD;\n  const altitudeDiff = (point.altitude || 0) - (origin.altitude || 0);\n\n  const x = longitudeDiff * earthRadius * Math.cos(origin.latitude * MathUtils.DEG2RAD);\n  const y = altitudeDiff;\n\n  // dynamic step size based on latitude difference. calculate the mercator unit scale at origin\n  // and the scale average along the line to the point for better accuracy far from origin\n  const steps = Math.ceil(Math.abs(point.latitude - origin.latitude)) * 100 + 1;\n  const avgScale = averageMercatorScale(origin.latitude, point.latitude, steps);\n\n  const z = ((-latitudeDiff * earthRadius) / getMercatorScale(origin.latitude)) * avgScale;\n  return [x, y, z] as Vector3Tuple;\n}", "import { memo, useMemo } from \"react\";\nimport { useCoords } from \"../core/use-coords\";\nimport { CoordinatesProps } from \"./coordinates\";\nimport { coordsToVector3 } from \"./coords-to-vector-3\";\n\nexport const NearCoordinates = memo<CoordinatesProps>(({children, ...coords})=>{\n  const {latitude, longitude, altitude} = useCoords();\n  const pos = useMemo(()=>coordsToVector3(coords, {latitude, longitude, altitude}), [ // eslint-disable-line react-hooks/exhaustive-deps\n    latitude, longitude, altitude, coords.latitude, coords.longitude, coords.altitude\n  ]);\n  return <object3D position={pos}>{children}</object3D>\n})\nNearCoordinates.displayName = 'NearCoordinates';", "import { MathUtils, Vector3Tuple } from \"three\";\nimport { Coords } from \"./coords\";\nimport { earthRadius } from \"../core/earth-radius\";\n\nexport function vector3ToCoords(position: Vector3Tuple, origin: Coords): Coords {\n  const [x, y, z] = position;\n  const latitude = origin.latitude + (-z / earthRadius) * MathUtils.RAD2DEG;\n  const longitude = origin.longitude + (x / earthRadius) * MathUtils.RAD2DEG / Math.cos(origin.latitude * MathUtils.DEG2RAD);\n  const altitude = (origin.altitude || 0) + y;\n  const coords: Coords = { latitude, longitude, altitude };\n  return coords;\n}", "import type { Map } from 'maplibre-gl';\nimport { useMap as useMapGeneric } from './api/use-map';\n\nexport * from './api';\nexport * from './maplibre/canvas';\n\nexport const useMap = useMapGeneric<Map>;\n"],
  "mappings": "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",
  "names": ["useMap", "fromLngLat", "fromLngLat", "m4", "projByViewInv", "useThree", "fiberEvents", "fromLngLat", "useThree", "canvas", "root", "r3m", "fromLngLat", "useThree", "fromLngLat", "el", "Canvas", "pos", "useMap", "useMapGeneric"]
}
